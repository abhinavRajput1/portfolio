<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Neon Phishing Link Detector</title>
	<script src="https://cdn.tailwindcss.com"></script>
	<meta name="description" content="Check if a link looks suspicious with an interactive neon phishing detector.">
	<!-- Spline web component for interactive 3D background -->
	<script type="module" src="https://unpkg.com/@splinetool/viewer@1.10.57/build/spline-viewer.js"></script>
	<style>
		@keyframes glowPulse {
			0%, 100% { box-shadow: 0 0 18px rgba(59,130,246,0.35), 0 0 42px rgba(168,85,247,0.15); }
			50% { box-shadow: 0 0 26px rgba(59,130,246,0.55), 0 0 64px rgba(168,85,247,0.25); }
		}
		@keyframes fadeInUp {
			0% { opacity: 0; transform: translateY(8px); }
			100% { opacity: 1; transform: translateY(0); }
		}
		@keyframes placeholderPulse {
			0%, 100% { color: rgba(156,163,175,0.45); }
			50% { color: rgba(156,163,175,0.8); }
		}
		.animate-glow { animation: glowPulse 2.2s ease-in-out infinite; }
		.fade-in-up { animation: fadeInUp .35s ease-out both; }
		input::placeholder { animation: placeholderPulse 2.2s ease-in-out infinite; }

		/* Respect reduced motion preferences */
		@media (prefers-reduced-motion: reduce) {
			.animate-glow { animation: none; }
			.fade-in-up { animation: none; }
			input::placeholder { animation: none; }
		}

		/* Light theme overrides */
		body.theme-light { background-color: #ffffff; color: #111827; }
		body.theme-light .selection\:bg-fuchsia-500\/30 { background-color: rgba(217,70,239,0.18); }
		body.theme-light .surface { background-color: #ffffff !important; border-color: rgba(0,0,0,0.08) !important; box-shadow: 0 10px 30px rgba(17,24,39,0.06), inset 0 0 0 1px rgba(0,0,0,0.04) !important; }
		body.theme-light .field { background-color: #ffffff !important; color: #111827 !important; border-color: rgba(0,0,0,0.15) !important; }
		body.theme-light .text-gray-300 { color: #374151 !important; }
		body.theme-light .text-gray-400 { color: #6b7280 !important; }
		body.theme-light .text-gray-500 { color: #6b7280 !important; }
		body.theme-light .bg-black\/40 { background-color: rgba(255,255,255,0.8) !important; }
	</style>
</head>
<body class="min-h-screen bg-black text-gray-200 selection:bg-fuchsia-500/30 selection:text-white">
	<!-- Interactive Spline background -->
	<div id="bgWrap" class="fixed inset-0 -z-10" style="transform: translate3d(var(--bg-x,0px), var(--bg-y,0px), 0) scale(var(--bg-scale,1)); will-change: transform;">
		<spline-viewer url="https://prod.spline.design/aIroXlbiSQ4TaqQB/scene.splinecode" loading-anim="true" style="width:100%;height:100%;display:block;"></spline-viewer>
	</div>
	<div class="relative">
		<div class="pointer-events-none absolute inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-fuchsia-500/10 via-transparent to-transparent"></div>
		<div class="pointer-events-none absolute -top-24 -left-24 h-72 w-72 rounded-full bg-fuchsia-600/20 blur-3xl"></div>
		<div class="pointer-events-none absolute -bottom-24 -right-24 h-72 w-72 rounded-full bg-blue-600/20 blur-3xl"></div>

		<!-- Top bar with theme toggle -->
		<div class="relative z-10 flex w-full flex-wrap items-center justify-end px-4 pt-4 gap-2">
			<button id="themeToggle" class="group inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-2 text-xs text-gray-300 backdrop-blur-md transition hover:bg-white/10">
				<span id="themeIcon" aria-hidden="true">
					<!-- Moon (night) icon default -->
					<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-fuchsia-300 group-hover:scale-110 transition" viewBox="0 0 24 24" fill="currentColor"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79Z"/></svg>
				</span>
				<span id="themeLabel">Dark</span>
			</button>
		</div>
	</div>

	<main class="relative z-10 flex items-center justify-center px-4 py-12 sm:py-16">
		<div class="w-full max-w-xl md:max-w-2xl lg:max-w-3xl">
			<div class="mx-auto mb-8 flex items-center justify-center gap-3">
				<div class="h-2 w-2 rounded-full bg-fuchsia-500 shadow-[0_0_18px_6px_rgba(217,70,239,0.55)]"></div>
				<p class="text-xs tracking-widest text-gray-400 uppercase">Realtime URL sanity check</p>
				<div class="h-2 w-2 rounded-full bg-blue-500 shadow-[0_0_18px_6px_rgba(59,130,246,0.55)]"></div>
			</div>

			<div class="rounded-2xl border border-white/10 bg-white/[0.04] backdrop-blur-xl p-6 sm:p-8 shadow-[0_0_60px_rgba(168,85,247,0.08),inset_0_0_0_1px_rgba(255,255,255,0.04)] animate-glow surface">
				<h1 class="mb-6 text-center text-2xl font-semibold tracking-tight text-white sm:text-3xl">
					Neon Phishing Link Detector
				</h1>

				<div class="mb-4 flex items-stretch gap-3">
					<div class="relative flex-1">
						<input id="urlInput" type="url" spellcheck="false" inputmode="url" autocomplete="off" autocapitalize="off" aria-label="URL"
							   class="field peer w-full rounded-xl border border-white/10 bg-black/40 px-4 py-3 pr-9 text-sm text-gray-100 outline-none transition focus:border-fuchsia-500/60 focus:ring-2 focus:ring-fuchsia-500/30 focus:bg-black/30" />
						<button id="clearInput" type="button" aria-label="Clear URL"
								class="absolute right-2 top-1/2 -translate-y-1/2 hidden text-gray-400 hover:text-gray-200 transition">
							<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><path d="M6 18 18 6M6 6l12 12"/></svg>
						</button>
						<div class="pointer-events-none absolute inset-0 rounded-xl ring-1 ring-inset ring-white/5 peer-focus:ring-fuchsia-500/30"></div>
						<div id="typingGlow" class="pointer-events-none absolute -inset-px rounded-xl opacity-0 transition-opacity peer-focus:opacity-100
												 shadow-[0_0_32px_2px_rgba(217,70,239,0.3)]"></div>
					</div>
					<button id="checkBtn"
							class="group relative inline-flex items-center justify-center overflow-hidden rounded-xl bg-gradient-to-r from-fuchsia-600 to-blue-600 px-4 sm:px-5 py-3 text-sm font-medium text-white transition focus:outline-none active:scale-[.99]">
						<span class="absolute inset-0 -z-10 translate-y-10 bg-white/20 opacity-0 transition group-hover:opacity-100 group-hover:translate-y-0"></span>
						<span class="mr-2 inline-block h-2 w-2 rounded-full bg-white/80 shadow-[0_0_18px_6px_rgba(255,255,255,0.55)] group-hover:scale-110 transition"></span>
						Check Link
					</button>
				</div>
				<div class="flex items-center justify-between text-xs text-gray-400">
					<p>Simple offline rules. No data is sent to any server.</p>
					<button id="exampleBtn" class="text-fuchsia-300 hover:text-fuchsia-200">Try an example</button>
				</div>

				<div id="result" class="mt-6 hidden">
					<div id="alertBox" class="fade-in-up rounded-xl border px-4 py-3 text-sm shadow-lg transition-all">
						<div class="flex items-start gap-3">
							<div id="alertIcon" class="mt-[2px] h-5 w-5 shrink-0"></div>
							<div class="flex-1">
								<p id="alertTitle" class="font-medium"></p>
								<p id="alertDesc" class="mt-1 text-gray-300"></p>
							</div>
						</div>

					<!-- Detailed Results Card -->
					<div id="scanDetails" class="mt-6 hidden rounded-2xl border border-white/10 bg-white/[0.04] backdrop-blur-xl p-5 sm:p-6 shadow-[0_0_60px_rgba(168,85,247,0.08),inset_0_0_0_1px_rgba(255,255,255,0.04)] transition-all surface">
						<!-- Status metrics -->
						<div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
							<div class="rounded-xl border border-white/10 bg-white/5 p-4">
								<p class="text-xs text-gray-400">Scan Status</p>
								<p id="metricStatus" class="mt-1 font-medium text-gray-100">-</p>
							</div>
							<div class="rounded-xl border border-white/10 bg-white/5 p-4">
								<p class="text-xs text-gray-400">Domain Age</p>
								<p id="metricDomainAge" class="mt-1 font-medium text-gray-100">-</p>
							</div>
							<div class="rounded-xl border border-white/10 bg-white/5 p-4">
								<p class="text-xs text-gray-400">SSL Certificate</p>
								<p id="metricSSL" class="mt-1 font-medium text-gray-100">-</p>
							</div>
						</div>

						<!-- Blacklist + Structure -->
						<div class="mt-4 grid grid-cols-1 sm:grid-cols-3 gap-3">
							<div class="rounded-xl border border-white/10 bg-white/5 p-4">
								<p class="text-xs text-gray-400">Blacklist Status</p>
								<p id="metricBlacklist" class="mt-1 font-medium text-gray-100">-</p>
							</div>
							<div class="sm:col-span-2 rounded-xl border border-white/10 bg-white/5 p-4">
								<p class="text-xs text-gray-400 mb-2">URL Structure Analysis</p>
								<ul id="structureList" class="space-y-2 text-sm"></ul>
							</div>
						</div>

						<!-- Domain info -->
						<div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3">
							<div class="rounded-xl border border-white/10 bg-white/5 p-4">
								<p class="text-xs text-gray-400">Registered To</p>
								<p id="infoRegistrant" class="mt-1 font-medium text-gray-100">-</p>
							</div>
							<div class="rounded-xl border border-white/10 bg-white/5 p-4">
								<p class="text-xs text-gray-400">Hosting Provider</p>
								<p id="infoHosting" class="mt-1 font-medium text-gray-100">-</p>
							</div>
							<div class="rounded-xl border border-white/10 bg-white/5 p-4">
								<p class="text-xs text-gray-400">Location</p>
								<p id="infoLocation" class="mt-1 font-medium text-gray-100">-</p>
							</div>
							<div class="rounded-xl border border-white/10 bg-white/5 p-4">
								<p class="text-xs text-gray-400">IP Address</p>
								<p id="infoIP" class="mt-1 font-medium text-gray-100">-</p>
							</div>
						</div>

						<!-- Recommendations -->
						<div class="mt-4 rounded-xl border border-white/10 bg-white/5 p-4">
							<p class="text-xs text-gray-400 mb-2">Recommendations</p>
							<ul id="recoList" class="space-y-2 text-sm"></ul>
						</div>
					</div>
				</div>

				<div class="mt-6 grid grid-cols-1 gap-3 sm:grid-cols-3 text-xs">
					<div id="chipKeywords" class="rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-gray-300">Keywords</div>
					<div id="chipHyphens" class="rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-gray-300">Hyphens</div>
					<div id="chipLength" class="rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-gray-300">Length</div>
				</div>
			</div>

			<p class="mx-auto mt-6 max-w-md text-center text-xs text-gray-500">
				Tip: Be cautious with shortened links, look for HTTPS, and never enter credentials after clicking unsolicited messages.
			</p>

			<!-- Security Tips -->
			<div class="mt-8 rounded-2xl border border-white/10 bg-white/[0.04] backdrop-blur-xl p-6 sm:p-8 shadow-[0_0_60px_rgba(59,130,246,0.06),inset_0_0_0_1px_rgba(255,255,255,0.04)] fade-in-up surface">
				<h2 class="mb-4 text-lg font-semibold text-white">Security Tips</h2>
				<div class="space-y-5 text-sm">
					<div class="flex items-start gap-3">
						<div class="mt-[2px] flex h-8 w-8 items-center justify-center rounded-full bg-emerald-500/15 text-emerald-300">
							<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41Z"/></svg>
						</div>
						<div>
							<p class="font-medium text-gray-100">Check for HTTPS</p>
							<p class="text-gray-400">Always look for "https://" and the padlock icon. These indicate an encrypted connection.</p>
						</div>
					</div>
					<div class="flex items-start gap-3">
						<div class="mt-[2px] flex h-8 w-8 items-center justify-center rounded-full bg-fuchsia-500/15 text-fuchsia-300">
							<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a10 10 0 1 0 10 10A10.011 10.011 0 0 0 12 2Zm1 15h-2v-2h2Zm0-4h-2V7h2Z"/></svg>
						</div>
						<div>
							<p class="font-medium text-gray-100">Verify the Domain Name</p>
							<p class="text-gray-400">Phishers mimic brands with small changes (e.g., "paypai.com"). Double‑check the domain.</p>
						</div>
					</div>
					<div class="flex items-start gap-3">
						<div class="mt-[2px] flex h-8 w-8 items-center justify-center rounded-full bg-amber-500/15 text-amber-300">
							<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21Zm12-3h-2v-2h2Zm0-4h-2v-4h2Z"/></svg>
						</div>
						<div>
							<p class="font-medium text-gray-100">Don't Trust Suspicious Links</p>
							<p class="text-gray-400">Avoid clicking links requesting personal info. Go directly to the official site.</p>
						</div>
					</div>
				</div>
			</div>

			<!-- Recent Scans -->
			<div class="mt-8 rounded-2xl border border-white/10 bg-white/[0.04] backdrop-blur-xl p-6 sm:p-8 shadow-[0_0_60px_rgba(217,70,239,0.06),inset_0_0_0_1px_rgba(255,255,255,0.04)] fade-in-up surface">
				<h2 class="mb-4 text-lg font-semibold text-white">Recent Scans</h2>
				<div class="space-y-3 text-sm">
					<div class="flex items-center justify-between rounded-xl border border-red-500/30 bg-red-500/10 px-4 py-3">
						<div class="flex items-center gap-3">
							<div class="flex h-9 w-9 items-center justify-center rounded-full bg-red-500/20 text-red-300">
								<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a10 10 0 1 0 10 10A10.011 10.011 0 0 0 12 2Zm1 15h-2v-2h2Zm0-4h-2V7h2Z"/></svg>
							</div>
							<div>
								<p class="font-medium text-gray-100">paypai-login.com</p>
								<p class="text-xs text-red-200/80">High Risk Phishing</p>
							</div>
						</div>
						<button class="text-xs font-medium text-fuchsia-300 hover:text-fuchsia-200">View Details</button>
					</div>
					<div class="flex items-center justify-between rounded-xl border border-amber-500/30 bg-amber-500/10 px-4 py-3">
						<div class="flex items-center gap-3">
							<div class="flex h-9 w-9 items-center justify-center rounded-full bg-amber-500/20 text-amber-200">
								<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21Zm12-3h-2v-2h2Zm0-4h-2v-4h2Z"/></svg>
							</div>
							<div>
								<p class="font-medium text-gray-100">netflix-support.help</p>
								<p class="text-xs text-amber-200/80">Suspicious Activity</p>
							</div>
						</div>
						<button class="text-xs font-medium text-fuchsia-300 hover:text-fuchsia-200">View Details</button>
					</div>
					<div class="flex items-center justify-between rounded-xl border border-emerald-500/30 bg-emerald-500/10 px-4 py-3">
						<div class="flex items-center gap-3">
							<div class="flex h-9 w-9 items-center justify-center rounded-full bg-emerald-500/20 text-emerald-200">
								<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41Z"/></svg>
							</div>
							<div>
								<p class="font-medium text-gray-100">amazon.com</p>
								<p class="text-xs text-emerald-200/80">Verified Safe</p>
							</div>
						</div>
						<button class="text-xs font-medium text-fuchsia-300 hover:text-fuchsia-200">View Details</button>
					</div>
				</div>
			</div>
		</div>
	</main>

	<!-- Analyzing overlay -->
	<div id="analyzeOverlay" class="pointer-events-none fixed inset-0 z-20 hidden items-center justify-center p-6">
		<div class="pointer-events-auto w-full max-w-sm rounded-2xl border border-white/10 bg-black/60 backdrop-blur-xl p-6 text-center shadow-[0_0_60px_rgba(168,85,247,0.15),inset_0_0_0_1px_rgba(255,255,255,0.04)]">
			<div class="mx-auto mb-4 h-14 w-14">
				<div class="loader3d h-14 w-14"></div>
			</div>
			<p class="text-sm text-gray-200">Analyzing URL…</p>
			<p class="mt-1 text-xs text-gray-400">Running heuristic checks</p>
		</div>
	</div>

	<style>
		/* 3D-style rotating orb loader */
		@keyframes spin3d { to { transform: rotate3d(0.5, 0.8, 0.2, 360deg); } }
		.loader3d { 
			border-radius: 9999px; 
			background: radial-gradient(closest-side, rgba(255,255,255,0.9), rgba(255,255,255,0.1) 60%, transparent 70%),
				conic-gradient(from 0deg, rgba(217,70,239,0.9), rgba(59,130,246,0.9), rgba(217,70,239,0.9));
			mask: radial-gradient(farthest-side, transparent 55%, #000 56%);
			animation: spin3d 1.2s linear infinite;
			filter: drop-shadow(0 0 12px rgba(217,70,239,0.45)) drop-shadow(0 0 18px rgba(59,130,246,0.35));
		}
	</style>

	<script>
		const input = document.getElementById('urlInput');
		const button = document.getElementById('checkBtn');
		const resultWrap = document.getElementById('result');
		const alertBox = document.getElementById('alertBox');
		const alertIcon = document.getElementById('alertIcon');
		const alertTitle = document.getElementById('alertTitle');
		const alertDesc = document.getElementById('alertDesc');
		const chipKeywords = document.getElementById('chipKeywords');
		const chipHyphens = document.getElementById('chipHyphens');
		const chipLength = document.getElementById('chipLength');
		const exampleBtn = document.getElementById('exampleBtn');
		const clearBtn = document.getElementById('clearInput');

		const suspiciousKeywords = ['login','verify','update','secure','account','password','signin'];

		function classify(urlText) {
			let score = 0;
			let notes = [];
			let host = '';

			try {
				const u = new URL(urlText);
				host = u.hostname;
			} catch (e) {
				// Not a valid absolute URL; try to coerce by adding protocol
				try {
					const u2 = new URL('https://' + urlText.replace(/^\/+/, ''));
					host = u2.hostname;
				} catch (_) {
					notes.push('Invalid URL format. Use full URL like https://example.com');
					score += 2;
				}
			}

			const lower = urlText.toLowerCase();

			// Keyword rule
			const matched = suspiciousKeywords.filter(k => lower.includes(k));
			if (matched.length) {
				notes.push('Suspicious keywords: ' + matched.join(', '));
				score += Math.min(2, matched.length);
			}

			// Hyphen rule
			const hyphenCount = (host.match(/-/g) || []).length;
			if (hyphenCount >= 3) {
				notes.push('Too many hyphens in domain (' + hyphenCount + ').');
				score += 2;
			} else if (hyphenCount === 2) {
				notes.push('Multiple hyphens in domain.');
				score += 1;
			}

			// Length rule
			if (lower.length > 120) { notes.push('Very long URL.'); score += 2; }
			else if (lower.length > 80) { notes.push('Long URL.'); score += 1; }

			// @ symbol rule
			if (lower.includes('@')) { notes.push('Contains @ in URL.'); score += 1; }

			// Punycode rule
			if (host.startsWith('xn--')) { notes.push('Punycode domain (lookalike risk).'); score += 2; }

			// Simple verdict
			let verdict = 'safe';
			if (score >= 4) verdict = 'suspicious';
			else if (score >= 2) verdict = 'warning';

			return { score, verdict, notes, hyphenCount, keywordsHit: matched.length, length: lower.length };
		}

		function renderChips(analysis) {
			chipKeywords.className = 'rounded-lg border px-3 py-2 text-xs ' + (analysis.keywordsHit ? 'border-red-400/40 bg-red-500/10 text-red-200' : 'border-emerald-400/30 bg-emerald-500/10 text-emerald-200');
			chipKeywords.textContent = analysis.keywordsHit ? `Keywords: ${analysis.keywordsHit}` : 'Keywords: none';

			chipHyphens.className = 'rounded-lg border px-3 py-2 text-xs ' + (analysis.hyphenCount >= 2 ? 'border-amber-400/40 bg-amber-500/10 text-amber-200' : 'border-emerald-400/30 bg-emerald-500/10 text-emerald-200');
			chipHyphens.textContent = `Hyphens: ${analysis.hyphenCount}`;

			chipLength.className = 'rounded-lg border px-3 py-2 text-xs ' + (analysis.length > 80 ? 'border-fuchsia-400/40 bg-fuchsia-500/10 text-fuchsia-200' : 'border-emerald-400/30 bg-emerald-500/10 text-emerald-200');
			chipLength.textContent = `Length: ${analysis.length}`;
		}

		function showResult(analysis) {
			resultWrap.classList.remove('hidden');

			if (analysis.verdict === 'suspicious') {
				alertBox.className = 'fade-in-up rounded-xl border px-4 py-3 text-sm shadow-lg transition-all border-red-500/40 bg-red-500/10';
				alertIcon.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-red-400" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a10 10 0 1010 10A10.011 10.011 0 0012 2Zm1 15h-2v-2h2Zm0-4h-2V7h2Z"/></svg>';
				alertTitle.textContent = 'Suspicious link detected';
				alertDesc.textContent = analysis.notes.join(' • ');
			} else if (analysis.verdict === 'warning') {
				alertBox.className = 'fade-in-up rounded-xl border px-4 py-3 text-sm shadow-lg transition-all border-amber-500/40 bg-amber-500/10';
				alertIcon.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-amber-300" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21Zm12-3h-2v-2h2Zm0-4h-2v-4h2Z"/></svg>';
				alertTitle.textContent = 'Potentially risky';
				alertDesc.textContent = analysis.notes.join(' • ');
			} else {
				alertBox.className = 'fade-in-up rounded-xl border px-4 py-3 text-sm shadow-lg transition-all border-emerald-500/40 bg-emerald-500/10';
				alertIcon.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-emerald-300" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41Z"/></svg>';
				alertTitle.textContent = 'Looks safe';
				alertDesc.textContent = analysis.notes.length ? analysis.notes.join(' • ') : 'No obvious red flags found.';
			}

			// Populate detailed card with mock data
			const value = input.value.trim();
			let parsed;
			try { parsed = new URL(value); } catch { try { parsed = new URL('https://' + value.replace(/^\/+/, '')); } catch { parsed = null; } }

			const scanDetails = document.getElementById('scanDetails');
			scanDetails.classList.remove('hidden');
			scanDetails.classList.add('fade-in-up');

			const metricStatus = document.getElementById('metricStatus');
			const metricDomainAge = document.getElementById('metricDomainAge');
			const metricSSL = document.getElementById('metricSSL');
			const metricBlacklist = document.getElementById('metricBlacklist');
			const structureList = document.getElementById('structureList');
			const infoRegistrant = document.getElementById('infoRegistrant');
			const infoHosting = document.getElementById('infoHosting');
			const infoLocation = document.getElementById('infoLocation');
			const infoIP = document.getElementById('infoIP');
			const recoList = document.getElementById('recoList');

			metricStatus.textContent = analysis.verdict === 'suspicious' ? 'Suspicious' : analysis.verdict === 'warning' ? 'Caution' : 'Safe';
			metricStatus.className = 'mt-1 font-medium ' + (analysis.verdict === 'suspicious' ? 'text-red-300' : analysis.verdict === 'warning' ? 'text-amber-200' : 'text-emerald-200');

			const domainAge = Math.random() < 0.5 ? `${Math.floor(Math.random()*9)+1} years` : `${Math.floor(Math.random()*20)+5} days`;
			metricDomainAge.textContent = domainAge;

			const sslOk = parsed ? parsed.protocol === 'https:' : false;
			metricSSL.textContent = sslOk ? 'Valid (HTTPS)' : 'Missing (HTTP)';
			metricSSL.className = 'mt-1 font-medium ' + (sslOk ? 'text-emerald-200' : 'text-red-300');

			const blacklisted = analysis.verdict === 'suspicious' && Math.random() < 0.6;
			metricBlacklist.textContent = blacklisted ? 'Reported' : 'Not Reported';
			metricBlacklist.className = 'mt-1 font-medium ' + (blacklisted ? 'text-red-300' : 'text-emerald-200');

			// Structure analysis bullets
			structureList.innerHTML = '';
			const addBullet = (text, bad) => {
				const li = document.createElement('li');
				li.className = 'flex items-start gap-2';
				li.innerHTML = (bad
					? '<svg xmlns="http://www.w3.org/2000/svg" class="mt-0.5 h-4 w-4 text-red-400" viewBox="0 0 24 24" fill="currentColor"><path d="M6 18 18 6M6 6l12 12"/></svg>'
					: '<svg xmlns="http://www.w3.org/2000/svg" class="mt-0.5 h-4 w-4 text-emerald-300" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41Z"/></svg>')
					+ '<span>' + text + '</span>';
				structureList.appendChild(li);
			};

			if (parsed) {
				const subdomains = parsed.hostname.split('.');
				if (subdomains.length > 2) addBullet('Multiple subdomains detected', true);
				if ((parsed.hostname.match(/-/g) || []).length >= 2) addBullet('Domain contains multiple hyphens', true);
				addBullet(sslOk ? 'Uses HTTPS (encrypted)' : 'Uses HTTP (unencrypted)', !sslOk);
				if (parsed.pathname.toLowerCase().includes('login') || parsed.pathname.toLowerCase().includes('signin')) {
					addBullet('Login-related path detected', true);
				}
			}

			// Domain info (mock)
			const hosts = ['Amazon Web Services', 'Cloudflare', 'Google Cloud', 'DigitalOcean', 'Azure'];
			const places = ['United States', 'Germany', 'Singapore', 'India', 'Netherlands'];
			const registrant = parsed ? (parsed.hostname.split('.')[0] + ' Inc.') : 'Unknown LLC';
			infoRegistrant.textContent = registrant;
			infoHosting.textContent = hosts[Math.floor(Math.random()*hosts.length)];
			infoLocation.textContent = places[Math.floor(Math.random()*places.length)];
			infoIP.textContent = `${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`;

			// Recommendations (mock)
			recoList.innerHTML = '';
			const recos = [];
			if (analysis.verdict !== 'safe') {
				recos.push('Avoid entering credentials on this site.');
				recos.push('Verify the link via official channels.');
			}
			recos.push('Enable two‑factor authentication on important accounts.');
			recos.push('Use a password manager to spot domain lookalikes.');
			recos.forEach(text => {
				const li = document.createElement('li');
				li.className = 'flex items-start gap-2';
				li.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="mt-0.5 h-4 w-4 text-fuchsia-300" viewBox="0 0 24 24" fill="currentColor"><circle cx="12" cy="12" r="3"/></svg>' + '<span>' + text + '</span>';
				recoList.appendChild(li);
			});

			// Smooth scroll into detailed results
			scanDetails.scrollIntoView({ behavior: 'smooth', block: 'start' });
		}

		function runCheck() {
 			const value = input.value.trim();
 			if (!value) { input.focus(); return; }
			// Show analyzing overlay and disable button
			const overlay = document.getElementById('analyzeOverlay');
			overlay.classList.remove('hidden');
			overlay.classList.add('flex');
			button.disabled = true;
			button.classList.add('opacity-70','cursor-not-allowed');
			setTimeout(() => {
				const a = classify(value);
				renderChips(a);
				showResult(a);
				overlay.classList.add('hidden');
				overlay.classList.remove('flex');
				button.disabled = false;
				button.classList.remove('opacity-70','cursor-not-allowed');
			}, 1600);
 		}

		input.addEventListener('input', () => {
			const a = classify(input.value.trim());
			renderChips(a);
			// Toggle clear button
			if (input.value.trim().length) clearBtn.classList.remove('hidden');
			else clearBtn.classList.add('hidden');
		});

		input.addEventListener('keydown', (e) => {
			if (e.key === 'Enter') {
				e.preventDefault();
				runCheck();
			}
		});

		button.addEventListener('click', runCheck);
		clearBtn.addEventListener('click', () => {
			input.value = '';
			clearBtn.classList.add('hidden');
			input.focus();
			renderChips({ keywordsHit: 0, hyphenCount: 0, length: 0 });
		});

		exampleBtn.addEventListener('click', () => {
			input.value = 'http://secure-update-login-example-verify-account.com/login';
			input.dispatchEvent(new Event('input'));
			runCheck();
		});

		// Initial chips state
		renderChips({ keywordsHit: 0, hyphenCount: 0, length: 0 });

		// Theme toggle
		const themeToggle = document.getElementById('themeToggle');
		const themeIcon = document.getElementById('themeIcon');
		const themeLabel = document.getElementById('themeLabel');

		function applyTheme(theme) {
			if (theme === 'light') {
				document.body.classList.add('theme-light');
				themeIcon.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-yellow-500" viewBox="0 0 24 24" fill="currentColor"><path d="M6.76 4.84l-1.8-1.79-1.41 1.41 1.79 1.8 1.42-1.42ZM1 13h3v-2H1v2Zm10 10h2v-3h-2v3Zm9.66-20.34-1.41-1.41-1.8 1.79 1.42 1.42 1.79-1.8ZM20 11v2h3v-2h-3Zm-9-7h2V1h-2v3Zm-6.24 14.16-1.79 1.8 1.41 1.41 1.8-1.79-1.42-1.42ZM17.24 18.16l1.42 1.42 1.79-1.8-1.41-1.41-1.8 1.79ZM12 7a5 5 0 1 0 5 5 5.006 5.006 0 0 0-5-5Z"/></svg>';
				themeLabel.textContent = 'Light';
			} else {
				document.body.classList.remove('theme-light');
				themeIcon.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-fuchsia-300" viewBox="0 0 24 24" fill="currentColor"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79Z"/></svg>';
				themeLabel.textContent = 'Dark';
			}
		}

		const savedTheme = localStorage.getItem('theme');
		applyTheme(savedTheme || 'dark');

		themeToggle.addEventListener('click', () => {
			const next = document.body.classList.contains('theme-light') ? 'dark' : 'light';
			applyTheme(next);
			localStorage.setItem('theme', next);
		});

		// Movable responsive Spline background
		const bgWrap = document.getElementById('bgWrap');
		bgWrap.style.transformOrigin = 'center center';

		function centerSpline() {
			const w = window.innerWidth;
			const h = window.innerHeight;
			let x = 0, y = 0, s = 1;
			// Heuristic centering: the earth appears low-left in this scene.
			if (w < 390) { s = 0.78; x = 36; y = -56; }
			else if (w < 480) { s = 0.82; x = 30; y = -48; }
			else if (w < 640) { s = 0.88; x = 24; y = -40; }
			else if (w < 768) { s = 0.95; x = 16; y = -28; }
			else if (w < 1024) { s = 1.0; x = 10; y = -20; }
			else { s = 1.05; x = 8; y = -16; }
			bgWrap.style.setProperty('--bg-x', x + 'px');
			bgWrap.style.setProperty('--bg-y', y + 'px');
			bgWrap.style.setProperty('--bg-scale', String(s));
		}

		centerSpline();
		window.addEventListener('resize', centerSpline);
	</script>
</body>
</html>
